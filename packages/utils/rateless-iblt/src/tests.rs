use super::encoding::*;
use super::testing::*;
use std::collections::BTreeSet;

#[test]
fn diff() {
    let alice: [TestU64; 10] = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    let bob: [TestU64; 10] = [1, 3, 4, 5, 6, 7, 8, 9, 10, 11];

    let mut enc = Encoder::<TestU64>::new();
    for x in alice {
        enc.add_symbol(&x);
    }

    let mut dec = Decoder::<TestU64>::new();
    for x in bob {
        dec.add_symbol(&x);
    }

    let mut cost = 0;

    loop {
        let s = enc.produce_next_coded_symbol();
        cost += 1;
        dec.add_coded_symbol(&s);
        assert!(!dec.try_decode().is_err());
        if dec.decoded() {
            break;
        }
    }

    //  2 is exclusive to Alice
    assert_eq!(dec.remote.symbols[0].symbol, 2);

    //  11 is exclusive to Bob
    assert_eq!(dec.local.symbols[0].symbol, 11);

    assert_eq!(cost, 2);
}

#[test]
fn encode_and_decode() {
    let mut enc = Encoder::<TestSymbol>::new();
    let mut dec = Decoder::<TestSymbol>::new();

    let mut local = BTreeSet::<u64>::new();
    let mut remote = BTreeSet::<u64>::new();

    let nlocal = 5000; // 50000;
    let nremote = 5000; // 50000;
    let ncommon = 10000; // 100000;

    let mut next_id: u64 = 0;

    for _ in 0..nlocal {
        let s = new_test_symbol(next_id);
        next_id += 1;
        dec.add_symbol(&s);
        local.insert(s.hash());
    }
    for _ in 0..nremote {
        let s = new_test_symbol(next_id);
        next_id += 1;
        enc.add_symbol(&s);
        remote.insert(s.hash());
    }
    for _ in 0..ncommon {
        let s = new_test_symbol(next_id);
        next_id += 1;
        enc.add_symbol(&s);
        dec.add_symbol(&s);
    }

    let mut ncw = 0;

    loop {
        dec.add_coded_symbol(&enc.produce_next_coded_symbol());
        ncw += 1;
        assert!(!dec.try_decode().is_err());
        if dec.decoded() {
            break;
        }
    }

    for v in dec.remote.symbols.iter() {
        remote.remove(&v.hash);
    }

    for v in dec.local.symbols.iter() {
        local.remove(&v.hash);
    }

    assert_eq!(remote.len(), 0);
    assert_eq!(local.len(), 0);
    assert!(dec.decoded());

    println!("{} codewords until fully decoded", ncw);
}

#[test]
fn encode_to_decoder() {
    let alice: [TestU64; 10] = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    let bob: [TestU64; 10] = [1, 3, 4, 5, 6, 7, 8, 9, 10, 11];

    let mut enc = Encoder::<TestU64>::new();
    for x in alice {
        enc.add_symbol(&x);
    }

    let mut enc2: Encoder<u64> = Encoder::<TestU64>::new();
    for x in bob {
        enc2.add_symbol(&x);
    }

    let mut dec = enc2.to_decoder();

    let mut cost = 0;

    loop {
        let s = enc.produce_next_coded_symbol();
        cost += 1;
        dec.add_coded_symbol(&s);
        assert!(!dec.try_decode().is_err());
        if dec.decoded() {
            break;
        }
    }

    //  2 is exclusive to Alice
    assert_eq!(dec.remote.symbols[0].symbol, 2);

    //  11 is exclusive to Bob
    assert_eq!(dec.local.symbols[0].symbol, 11);

    assert_eq!(cost, 2);
}

#[test]
fn reset() {
    let alice_0: [TestU64; 10] = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    let bob_0: [TestU64; 10] = [1, 3, 4, 5, 6, 7, 8, 9, 10, 11];
    let alice_1: [TestU64; 10] = [1, 2, 3, 4, 5, 6, 7, 8, 10, 11];
    let bob_1: [TestU64; 10] = [1, 2, 4, 5, 6, 7, 8, 9, 10, 11];

    let mut enc = Encoder::<TestU64>::new();
    for x in alice_0 {
        enc.add_symbol(&x);
    }

    let mut dec = Decoder::<TestU64>::new();
    for x in bob_0 {
        dec.add_symbol(&x);
    }

    let mut cost = 0;

    loop {
        let s = enc.produce_next_coded_symbol();
        cost += 1;
        dec.add_coded_symbol(&s);
        assert!(!dec.try_decode().is_err());
        if dec.decoded() {
            break;
        }
    }

    enc.reset();
    dec.reset();

    for x in alice_1 {
        enc.add_symbol(&x);
    }

    for x in bob_1 {
        dec.add_symbol(&x);
    }

    cost = 0;

    loop {
        let s = enc.produce_next_coded_symbol();
        cost += 1;
        dec.add_coded_symbol(&s);
        assert!(!dec.try_decode().is_err());
        if dec.decoded() {
            break;
        }
    }

    //  3 is exclusive to Alice
    assert_eq!(dec.remote.symbols[0].symbol, 3);

    //  9 is exclusive to Bob
    assert_eq!(dec.local.symbols[0].symbol, 9);

    assert_eq!(cost, 2);
}

#[test]
fn get_symbols() {
    let alice: [TestU64; 10] = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    let bob: [TestU64; 10] = [1, 3, 4, 5, 6, 7, 8, 9, 10, 11];

    let mut enc = Encoder::<TestU64>::new();
    for x in alice {
        enc.add_symbol(&x);
    }

    let mut dec = Decoder::<TestU64>::new();
    for x in bob {
        dec.add_symbol(&x);
    }

    let mut cost = 0;

    loop {
        let s = enc.produce_next_coded_symbol();
        cost += 1;
        dec.add_coded_symbol(&s);
        assert!(!dec.try_decode().is_err());
        if dec.decoded() {
            break;
        }
    }

    let remote = dec.get_remote_symbols();
    let local = dec.get_local_symbols();

    //  2 is exclusive to Alice
    assert_eq!(remote[0].symbol, 2);

    //  11 is exclusive to Bob
    assert_eq!(local[0].symbol, 11);

    assert_eq!(cost, 2);
}

#[test]
fn test_remove_symbol() {
    let mut encoder = Encoder::<TestU64>::new();

    // Add symbols to the encoder
    encoder.add_symbol(&1);
    encoder.add_symbol(&2);
    encoder.add_symbol(&3);

    assert_eq!(encoder.symbols.len(), 3);

    // Remove a symbol
    encoder.remove_symbol(&2);

    // Check that the symbol was removed
    assert_eq!(encoder.symbols.len(), 2);
    assert!(!encoder.symbols.iter().any(|s| s.symbol == 2));

    // Check that mappings and queue are updated correctly
    assert_eq!(encoder.mappings.len(), 2);
    assert_eq!(encoder.queue.len(), 2);
    assert!(encoder.queue.iter().all(|sm| sm.source_idx < 2));

    // Ensure that the heap property is maintained
    for i in 1..encoder.queue.len() {
        let parent = (i - 1) / 2;
        assert!(
            encoder.queue[parent].coded_idx <= encoder.queue[i].coded_idx,
            "Heap property violated at index {}",
            i
        );
    }
}

#[test]
fn test_diff_after_removal_of_symbol() {
    let alice: [TestU64; 5] = [1, 2, 3, 5, 10];
    let bob: [TestU64; 4] = [1, 2, 3, 6];

    let mut enc = Encoder::<TestU64>::new();
    for x in alice {
        enc.add_symbol(&x);
    }

    enc.remove_symbol(&10);

    let mut dec = Decoder::<TestU64>::new();
    for x in bob {
        dec.add_symbol(&x);
    }

    let mut cost = 0;

    loop {
        let s = enc.produce_next_coded_symbol();
        cost += 1;
        dec.add_coded_symbol(&s);
        assert!(!dec.try_decode().is_err());
        if dec.decoded() {
            break;
        }
    }

    //  5 is exclusive to Alice
    assert_eq!(dec.remote.symbols[0].symbol, 5);

    //  6 is exclusive to Bob
    assert_eq!(dec.local.symbols[0].symbol, 6);

    assert_eq!(cost, 2);
}

#[test]
fn test_clone() {
    let alice: [TestU64; 5] = [1, 2, 3, 5, 10];
    let mut enc = Encoder::<TestU64>::new();
    for x in alice {
        enc.add_symbol(&x);
    }

    // produce some symbols and reuse and produce the same symbols and assert they are equal
    let mut enc2 = enc.clone();

    let mut produces: Vec<CodedSymbol<TestU64>> = Vec::new();
    for _ in 0..10 {
        produces.push(enc.produce_next_coded_symbol());
    }

    for i in 0..10 {
        assert_eq!(enc2.produce_next_coded_symbol(), produces[i]);
    }
}
const MAPPING_REF: [u64; 2000] = [
    2,
    3,
    9,
    10,
    11,
    16,
    27,
    31,
    42,
    133,
    258,
    271,
    1969,
    2167,
    4018,
    19352,
    25878,
    38498,
    40513,
    64416,
    169690,
    740928,
    1519972,
    1968074,
    8208040,
    10400231,
    11695869,
    12610398,
    13893610,
    17287422,
    18066631,
    23660562,
    25888307,
    179863602,
    215986671,
    801810653,
    3402781043,
    4764885828,
    5866803996,
    7543450409,
    12720236490,
    13661179802,
    13753445813,
    111830685287,
    195882855340,
    226531037293,
    242336935646,
    1129731321329,
    1294351746820,
    1599276494338,
    5057796363277,
    16408421055474,
    22599230754570,
    59952571173986,
    78564300477335,
    89699944202590,
    157610705439900,
    219719584416704,
    481011332100199,
    769537964478830,
    1951573105410798,
    10085780461085687,
    13787072445283817,
    37342710031612493,
    59480048735071153,
    121481616280401865,
    793200340131224137,
    2412173016519570249,
    3146877963700278857,
    3268001426615912441,
    5674548168104436217,
    5956047874350559353,
    8538589375516646521,
    9187948460596693497,
    9287078302212508649,
    11901191482218757609,
    3039525328105790953,
    3160019853479824921,
    3316894547750845017,
    3360199901558658041,
    3973211352801976185,
    4495634179432494649,
    13839094117823393337,
    1873544722954184249,
    1978397965294508569,
    4106526400364231705,
    4106526400364231704,
    5748900985946378264,
    6413241262779981208,
    7540893577959613720,
    14503551309577267480,
    15808630469550402584,
    1342473340942458392,
    1424762746350639176,
    1684460149527201672,
    2379581915029727240,
    3747569155815616776,
    5592924978515277576,
    6066607445344116232,
    6390483890218260936,
    7400848894829915464,
    9114065277016819016,
    16187285940290710856,
    7849920258579342664,
    11101256641551275848,
    16129462018875097928,
    16129462018875097927,
    4801353112721507143,
    6136779504944517447,
    7503218853735661639,
    2080860561266718791,
    10786716632668951623,
    10786716632668951622,
    16961429938863261766,
    10311279425160263750,
    104292808938934342,
    134112991484844162,
    198471139819754274,
    733115700081127394,
    2089443019692571106,
    3369894856054728418,
    6050017276115829474,
    11936690373413264098,
    15562840077570483938,
    5636000350790340322,
    6351779967804027490,
    12469315387929274978,
    12469315387929274977,
    14633785144808694369,
    2279805332619779681,
    2419514708606640513,
    4704777080346762369,
    5201870862512480833,
    7012842863031724097,
    14150149540635211841,
    1331373460529622081,
    2149758645815525441,
    2329291395182032929,
    2329291395182032928,
    4232619690558051872,
    6056262690198436128,
    6468462729948783456,
    11038122849812092768,
    2591110160050411360,
    7672237843530619744,
    14304804239604551520,
    14304804239604551519,
    15619874751055778399,
    17743347839792802143,
    6058358948741427551,
    9303564995229632863,
    17729416846251748703,
    5369005043210817887,
    8569050157856370015,
    8569050157856370014,
    8569050157856370013,
    3227349021934157149,
    3535287945783948573,
    3935946846676377821,
    4236074163382057309,
    9107024244014938461,
    10914459567294415965,
    11667108085865846109,
    3662179474506839389,
    7967130254775215965,
    8830960836245594589,
    14905851974320035293,
    1007073299401230813,
    2245994131707039453,
    4143338838841905629,
    4337517823382254813,
    4337517823382254812,
    10109133361272261852,
    10134678711284725404,
    10134678711284725403,
    10134678711284725402,
    8941302127777003162,
    17843741186085099162,
    5949065987573128858,
    10547605048042827418,
    13614866558375183514,
    10704794643328619674,
    10704794643328619673,
    11098375608905362777,
    774368807631029593,
    1060479282120162617,
    1156698037664071209,
    1590750824257224489,
    1960183947388709929,
    2204782844626302121,
    5010682958806542505,
    5010682958806542504,
    5996548184666151848,
    10756391040068727720,
    14041383793343730088,
    16597313514341048744,
    9345895310700212648,
    10847562036107868840,
    10875646772256257720,
    10875646772256257719,
    11013737712730298087,
    16494856621529915111,
    8990302363676042983,
    1212708886654643943,
    1546773102096956071,
    1855797033275182567,
    1867403762412013191,
    2121163876524052615,
    2189469989128491199,
    4048073549205111999,
    4696327277030687039,
    5109128328956650239,
    11032757470468873983,
    11340821017985174975,
    13045245911355948991,
    16294018844911885759,
    15012600996198518207,
    5667489610198021567,
    6987594811386372543,
    11555425923718443967,
    4397077840473162687,
    212688111898520511,
    511935402764606847,
    765931598683386463,
    935962892665704287,
    1074947402708844895,
    2843137294803817311,
    4071635093069174879,
    13450160332418609247,
    17591506076150091871,
    17591506076150091870,
    17591506076150091869,
    17591506076150091868,
    3996360260946153564,
    9251564056549053532,
    12080025123908720220,
    11451311144194158172,
    14287408862835552348,
    14287408862835552347,
    14287408862835552346,
    7697035038012051546,
    10490906337534715482,
    12092945331948120410,
    12092945331948120409,
    17639632411565625689,
    4968025126303783257,
    7583734645732994393,
    10382747139942565209,
    10382747139942565208,
    749351793097401688,
    3115043874914375000,
    3375666296643347192,
    3581616863776224760,
    4073229105489566392,
    7264348951097761976,
    7264348951097761975,
    12460208134977411255,
    12460208134977411254,
    14822130477695273654,
    14896883595007080502,
    13481528102242852918,
    4504929675373891638,
    9059438753399210550,
    15536702655252100662,
    18212473996666107446,
    9735007041578853942,
    16721439083358467638,
    2006208160468298806,
    4121422338237695030,
    4616653305766488054,
    8427675690005462006,
    9297686377550328182,
    9765582082340188982,
    11573330517875114294,
    1648438546803889462,
    1824050446740942806,
    3242486533589436886,
    3455833905520347318,
    5746040762568682678,
    16919766134631230646,
    5495077392503105718,
    6505409277154677814,
    6853867560213600822,
    6872156644204672306,
    7615281762359784882,
    8879680434793755570,
    9146209630066408498,
    14340780210831361074,
    3677427333757067314,
    5936714088789761586,
    5936714088789761585,
    6924509312226656049,
    9298149807732436273,
    11442751604756895281,
    13627510964669988913,
    3242600861773065265,
    4418716695301362481,
    6279770279865943089,
    7080614287168706225,
    8868132673244289457,
    13250878510997881777,
    11140319760833881009,
    1386651027510632369,
    4879455484125002161,
    9807258256661681585,
    15254328444464814513,
    16861185821523256241,
    720561401534259633,
    1213326202632017457,
    1324923267627093009,
    2642886930942882065,
    4351366928436156177,
    10001443333026609937,
    4117712398055246609,
    8041725503837959953,
    5690686515061557009,
    9267760599216976657,
    13145745567287923985,
    535121766751720721,
    1776278538722383889,
    2819231399375208849,
    3156258793919518993,
    3195505683648100521,
    3909151620718254633,
    4041707011506702649,
    4415924873336150137,
    14623990791718021241,
    15304369016570783865,
    15304369016570783864,
    15492985554779062456,
    591712209572007096,
    1141041567186543672,
    6426935400094639160,
    12198487325760820280,
    12198487325760820279,
    1985207128622509111,
    4108397071827430967,
    5285663325754501687,
    8567963281274080311,
    9690436044127668279,
    13822575389986857015,
    16319747630671061047,
    16319747630671061046,
    6838110274107079734,
    17493640444133237814,
    2434946842334960182,
    2748641586803816246,
    8664059778309442358,
    17310887894315394870,
    8061747692493136694,
    10325187897630181174,
    13068215639429351222,
    14393009318676563254,
    16151308358003295542,
    16151308358003295541,
    16151308358003295540,
    16151308358003295539,
    3279103478365257011,
    7932421138780178739,
    10239360785730409779,
    16269469339889926451,
    17301577628376316595,
    7663399801777203,
    10111713497201638,
    16793534378646062,
    37796564450121254,
    40510573942190703,
    61095404467931503,
    90664919420718003,
    164225949503925331,
    167703546435912332,
    450030985582817068,
    607029827812203628,
    1715165266276769132,
    1982206033663210028,
    3274496668076299820,
    14632154208406124076,
    15193245561180224684,
    15193245561180224683,
    15193245561180224682,
    15193245561180224681,
    14693257013194747049,
    14693257013194747048,
    1260451792652077224,
    1817314206087697320,
    4598541984669108136,
    5065123073334363048,
    5065123073334363047,
    7913466063836160423,
    10034590712668692135,
    11779663320141337767,
    1852993380154852519,
    2029240397134927495,
    2527066433590579655,
    2670066914385354647,
    2794783324967854263,
    6695454003378708151,
    7054920514771564791,
    7392279547809657207,
    8460454710182186999,
    12100326690382434295,
    15502190327429098487,
    15376601188307016695,
    18367304860456649719,
    438745625002594359,
    455737588787321151,
    607876801982513823,
    691584183040083247,
    3782714566037112623,
    5582586217547786543,
    6033908658628388591,
    6263042309660455247,
    8992676503636456271,
    11456094689090022223,
    12253094249166591439,
    5004884290622160335,
    4802888933591418319,
    11602584180111897039,
    2551254008312383951,
    2858000437557115151,
    2893323042672188095,
    3490721800283430335,
    3599211071732072191,
    4146049438355731583,
    7785116432328217215,
    13662863109004246655,
    7434103734628214399,
    7598277463587282431,
    13167997918261143039,
    13649810065555690495,
    16219671385903446015,
    7124076053489528831,
    8095954420648467711,
    9455768188905832959,
    16006891143521369599,
    18304487460635246591,
    5985568248488173567,
    6670492080163209343,
    13006163544356538495,
    558981499886182527,
    734203918081934655,
    1306311136489416575,
    2199080194124775423,
    2204014970168438464,
    2677532920992289792,
    7763619023790427136,
    8061537008911296832,
    7994533451102937408,
    15733937288311780672,
    3645579292257011008,
    7575506083351276352,
    10522321382105718080,
    11627267256141996480,
    15529471346967541696,
    13518346408563013568,
    13789150794918120160,
    18295921206246532832,
    18295921206246532831,
    18295921206246532830,
    18295921206246532829,
    2455860669762837213,
    4863652702128650973,
    12801632327299876573,
    1744041328380590813,
    6120073262166574813,
    6405439158612758749,
    6803574031023280605,
    7332859202147331613,
    16963546894591522333,
    9663176594168378909,
    17289597825083598365,
    10595846411042084381,
    11237742828835274141,
    13521168706418817693,
    13521168706418817692,
    13521168706418817691,
    3734849715481359003,
    7059636390507414171,
    8098477720558839963,
    15655798136345616539,
    9053556749004941467,
    16654286657261163675,
    2438928347775514779,
    3499568405059315099,
    3653023030263055067,
    5734097350188369115,
    1796150891847507163,
    5297480757649161435,
    6737428511491960283,
    6737428511491960282,
    7862932842544314202,
    7862932842544314201,
    12628502756558249817,
    14066101229828399961,
    6506676357252694873,
    13970725504127661913,
    16518868686146604889,
    3182138951096461145,
    3467098968746149241,
    5824296719264797561,
    6299069438895972473,
    10852046434976852601,
    12647288613099902073,
    12647288613099902072,
    12647288613099902071,
    1197601911237631095,
    2536000324662698103,
    3360806796937775095,
    4264479948225387511,
    5648548827899768823,
    12360501644630577143,
    12575105432591125687,
    15414839324730960567,
    16831236938747147191,
    17386299312283135543,
    5350865444586980919,
    5350865444586980918,
    5846325935525269238,
    8493997117802679030,
    8493997117802679029,
    15233343920734526197,
    15233343920734526196,
    15233343920734526195,
    10402336415933627123,
    13306747317797690099,
    172423886554456819,
    235093768354044755,
    274278928091726155,
    815555173724480971,
    1358224609319414219,
    4114146503939427275,
    4114146503939427274,
    4842798692646627274,
    6073989416414690762,
    6387218905996121674,
    17768348201205147210,
    213827373535185866,
    224999651994780120,
    371661416072733752,
    512788446130206536,
    637004821074715992,
    812400060704099960,
    1010280335095798584,
    2011734429044706360,
    2140189181934856648,
    2540138820600191880,
    3392225995897270792,
    5877175894797278216,
    6444215418135477128,
    9589006231051259272,
    14356492983432860040,
    2141030629822185864,
    10291095590779518344,
    10804897693298627784,
    14434227708324260040,
    17367217914520751304,
    13977268904173001928,
    13977268904173001927,
    14201142646666160295,
    471405179039873191,
    628042997769406695,
    637937620029070897,
    1346442351500603441,
    1897346492384765681,
    9569736632675697393,
    11907002184982130417,
    12603131827748757745,
    12603131827748757744,
    4203489835472029936,
    14909711131972129008,
    13703067797726363888,
    13806918162867601904,
    13806918162867601903,
    17326301439671113199,
    5855221972805893615,
    8135803613048781807,
    2978513161234545647,
    3191627864187428431,
    9956375716763635279,
    10121944667464956687,
    10564601358692830543,
    4864112268851582287,
    1358700452733969743,
    3122688545059995215,
    3184823747257893431,
    5121220522120640567,
    12551354916339080247,
    16087851325076568631,
    1567013784948739127,
    3331402000051755319,
    7108355168516743479,
    7257938556249012503,
    12395575137879764247,
    2412335946019374359,
    2527260729504634535,
    2676081941794603335,
    7509834828231417159,
    12967781164392852807,
    1122689003859337543,
    1738081118764021191,
    2471327875145313863,
    2485305357076994673,
    2599724040082483329,
    2797044173890111617,
    4123438405324609665,
    10722935475910631553,
    11539252334849213825,
    12982136989933200513,
    13063484018031778353,
    14675222137969350961,
    5509222644882821425,
    6097201728669887793,
    7561455278321717809,
    10749712198971170353,
    10749712198971170352,
    11118451738346123312,
    7070221022846707760,
    7850211155200323632,
    7850211155200323631,
    10895131596388989999,
    10895131596388989998,
    3138488928871128110,
    4628097130719688750,
    4705375842631349630,
    6004909730802699134,
    6643109853932156286,
    11767303352613623166,
    3821486401272016254,
    10931270539226161534,
    16933746660186269054,
    8230936049701139838,
    12737286266577481086,
    12737286266577481085,
    17012244533832036733,
    18180890801861117821,
    4929885343274308477,
    6744103390834400125,
    7591044803972387581,
    17676747883797326589,
    1710654960804591357,
    1826830537258005069,
    2851993802345766861,
    4014290189392070605,
    4606220398090404685,
    1527257684351138637,
    1845586286293585805,
    2523793153998591757,
    2577285662229223429,
    4381791019784655109,
    12284476459794040069,
    15622054220470734597,
    3993037773802959621,
    7001729604456251141,
    8972819200975527173,
    14045638883308540165,
    14045638883308540164,
    14106481026365820660,
    14106481026365820659,
    14106481026365820658,
    18198746188065431282,
    3897442175926695666,
    3954958411078334402,
    1714165145075705794,
    2589591962139182658,
    2682979438433656098,
    6034984240696378658,
    7395936397114999842,
    16473600213173004322,
    4687821345277505570,
    7340934609458844706,
    10505047417595489314,
    16326696246595638306,
    2479502544030752802,
    7386151824240192546,
    9539142366847393314,
    1388848535703850530,
    1953073389858627682,
    3733296676614538594,
    6527091105387786594,
    6527091105387786593,
    6527091105387786592,
    6881586890081991520,
    12464956017750928224,
    677191353117629280,
    718386929126216032,
    1869622718624958688,
    2054581349096977120,
    2443112915582636128,
    2839173060003418464,
    5195927576969998688,
    9826550571260129632,
    12028162567179664736,
    16572473553400646496,
    2825960339134377824,
    5149349389599241056,
    10955254324236911456,
    16188401955194988384,
    2370942892202845024,
    5846634392391080800,
    8185994816344251744,
    14023610316681234784,
    4443301396598636896,
    5930489040908629088,
    10255336387203877984,
    10255336387203877983,
    11433565865794755423,
    1170766804768340831,
    1435283324628909023,
    3953284687349114335,
    4457245622288501727,
    5469474268941294943,
    10441150964351233375,
    10441150964351233374,
    11601251111242418014,
    1763195542727753566,
    1837728948154195678,
    3623280471072208862,
    4105534738515041118,
    4241284085090525790,
    10717726151308439134,
    10717726151308439133,
    4388233340257226333,
    5626040806428601181,
    6991682580491271517,
    8935411939880060765,
    14195493671570302813,
    15864339428889189213,
    15864339428889189212,
    4071698720759076700,
    5763105875874021980,
    5763105875874021979,
    12098150707851634267,
    13043237370565116763,
    3500436186422466395,
    3506542149752768640,
    7878312341747334784,
    17035409291051351680,
    6854293806235519616,
    15999300030099154560,
    7501375900319078016,
    11743171231527586944,
    12290431523090949248,
    1234559374866811008,
    1437766224176868480,
    2453919035704952192,
    2877263367353987584,
    4595086108069975040,
    5143798563027738944,
    6030783298970488384,
    18289787856074464832,
    10040684728529526336,
    12674337089460002880,
    17234889232432624704,
    16629229489473137728,
    7712984413556028480,
    7753663321175646488,
    10531078925226205976,
    14887937489276995864,
    15503293062566559896,
    12755487125347301528,
    18248150475905938584,
    5573294874704658584,
    8073790294759450776,
    9053494746822062744,
    9053494746822062743,
    12284951255820024983,
    3712006074869777559,
    4109618009464899415,
    4323262633161249367,
    7058203876470315095,
    8290772181976291415,
    8421869164889668647,
    10661024789238288679,
    436248196341287207,
    450784978247787933,
    1800543283741090717,
    3099944133626130077,
    5906692513761556125,
    18334543399677120157,
    1009855006753453469,
    1598356742800940061,
    2915969723578597149,
    4313139855520024605,
    10887788444399547421,
    17049939406656320541,
    16569748191391730717,
    3498163336521603101,
    17244879048921204765,
    5712562001479069725,
    7616053037155112477,
    7616053037155112476,
    10352391394980493852,
    12451468793125596700,
    2957476027545890332,
    3097371398935375084,
    3280589456226898444,
    4608344988203708428,
    5328517169964254732,
    8371884177507782668,
    11714007261664256524,
    11714007261664256523,
    12525986711352066955,
    12525986711352066954,
    14270455956347697290,
    2670973179265179786,
    2689591541810142914,
    3746005967071017794,
    4536832856672851906,
    10544004865515061186,
    706351010424615874,
    1573571788235460546,
    1581582820870426624,
    4152940247817247744,
    4655881756689642944,
    5701926937485794240,
    11026727211824601024,
    1666168095103582144,
    2071546857553993920,
    2326026564669060960,
    3755889887531971936,
    3994454971245137984,
    5094376675792070720,
    6416051241726226240,
    6973051309459127296,
    10816889179287808512,
    10816889179287808511,
    14626133090305324031,
    14626133090305324030,
    15406527937074692990,
    7287832884711306110,
    14429135190850205566,
    15833307679015403134,
    14205279123860727422,
    16874140183841068158,
    17084441953362490078,
    17084441953362490077,
    17084441953362490076,
    127889397896271580,
    252450723139095900,
    439966331021094044,
    449847069835553148,
    560163700073906268,
    1103206687310252828,
    2407368016850245660,
    7431141481035033628,
    9606885333568885020,
    2534543663765920028,
    3726098703991462428,
    4181157371493861660,
    6608480044305049372,
    8191577378584003868,
    1961290141505223964,
    2916086701140409500,
    4540217669290830492,
    6053557941134170524,
    6053557941134170523,
    14544476210220695963,
    16357457233179619739,
    17517284623978993051,
    17517284623978993050,
    3016394599199373722,
    3670588966335771546,
    4924856422828138906,
    6309613834694717594,
    272184248183302298,
    607330080953279642,
    714922197231861546,
    873698777898716106,
    1219573271260265418,
    1292531681867363882,
    1594016567402486634,
    2683576885721744618,
    3751931850710722922,
    521535283699659114,
    708486852023139178,
    1025742567306535914,
    1446138811524226986,
    2389699280010874026,
    6923280280055377066,
    8198842818068085418,
    8198842818068085417,
    12320291559544198313,
    9400853668371817641,
    14040587825164758185,
    14040587825164758184,
    15884176913516887208,
    1899270425208165544,
    4004338500207248040,
    8979276254422019752,
    10444890577497397928,
    15606643062409333416,
    8459523305353280168,
    8862507401590009896,
    10095970725061301544,
    11229941160548655016,
    12280920101255863592,
    8081130273348791592,
    9773011318298942760,
    11341193956986566184,
    1376969343288155688,
    2881554194483245096,
    3089740478265464552,
    3327339550474649160,
    3364397181626040856,
    4893221168889581848,
    3437775516054421784,
    8896002838824390936,
    2686469195368943896,
    4669936156622788888,
    6055702296815669016,
    11724632063987535640,
    13109529812107704856,
    12433935199602995736,
    15301325603370840600,
    17475976749011699480,
    17866445371019528536,
    3625267521999371096,
    4258706793516922072,
    4765357880920806040,
    5863817499257608088,
    5863817499257608087,
    17088763835666046871,
    17088763835666046870,
    17680901380690752278,
    18292610953008499094,
    11148215825253511574,
    7816817600800979350,
    9114247444007469206,
    1511388835463411862,
    2719218459272579990,
    7844460822910522262,
    12975515492048395158,
    6927710224568970134,
    3848479706511250326,
    3969950389959337510,
    4584901265357836070,
    6283991776912298534,
    11045952358039764518,
    15855504234265897510,
    4306872465958984230,
    5201815689055328422,
    6111920562831923878,
    6568196694870762214,
    8571158140569352678,
    10445048960766348262,
    13470277966276812262,
    3786135201332197862,
    9822189696817861094,
    9822189696817861093,
    11644156323941638373,
    11754059577782094037,
    11366906098552948949,
    2118095597433926869,
    5265636449667624661,
    5603343442595632789,
    7079599552202442133,
    9946140429763868053,
    9027435279280299413,
    9027435279280299412,
    9445610049022018004,
    11910097446707630036,
    11910097446707630035,
    11910097446707630034,
    255798921602212818,
    582875590123583762,
    654432092657539162,
    941825204317154138,
    969197382706799602,
    2101956294464611570,
    3016996606868097650,
    3745172501298307442,
    11296382027599154546,
    2216566037180491122,
    10587862906952171890,
    10587862906952171889,
    10657868832013220185,
    15524148418710711641,
    3392026838324267353,
    16497004712743807321,
    16497004712743807320,
    6705634318082896216,
    7841262213936617688,
    11354720427057428696,
    11794016347989165912,
    12882298425639143128,
    15065232187980461528,
    7360973375854243288,
    10331666052933145048,
    331022285745113560,
    412410177905431784,
    654158848034943848,
    1068648528843927976,
    4619486751907519400,
    5986393043440491176,
    6163231393693450696,
    6226638632947000752,
    8182803978756988592,
    8895079814176428080,
    12521664342870848048,
    13794982234146390320,
    17375865019722643760,
    6954619729724510512,
    14430893314247995696,
    16167225781188536880,
    16167225781188536879,
    18033100615745940271,
    18033100615745940270,
    5166133196801984302,
    13332115378936656686,
    15400649676237426734,
    10997831161920880686,
    10997831161920880685,
    13900956262600556589,
    4442348829623821357,
    6127194445592804141,
    6538002989186488813,
    12386034965187148269,
    997030431326847469,
    1003306887430542907,
    1690378565878190395,
    3003020181478337083,
    3074328476100917771,
    3236902413453164907,
    3971277471748861803,
    4255240429905547467,
    4519426003522297483,
    5865413147941299851,
    7319554201538699403,
    8451400965643207819,
    9834667420713259147,
    11296956657983972491,
    8599624391656256651,
    9922778480456777867,
    9922778480456777866,
    13859994480388296842,
    13859994480388296841,
    14474714474045948169,
    14474714474045948168,
    308875542952938248,
    404523171942102200,
    410070381125591131,
    425260101746810739,
    600586393441650515,
    801442085161952243,
    914610083719041603,
    1608627392804901059,
    1932062379091445699,
    3769647948093315267,
    4679791407024666947,
    6229040244644205123,
    7633030891562655299,
    10308588904585689155,
    10308588904585689154,
    11207595291438600898,
    2769168709690757826,
    4789340567267173826,
    7104429299009222594,
    7104429299009222593,
    11542920603218105281,
    8709531402246501313,
    4241164543833056193,
    4583181457551390913,
    9036754188274833601,
    11239752604911742913,
    11239752604911742912,
    12695432009250846400,
    12821757634110207024,
    501680895386929200,
    843927800961977968,
    925576475388633440,
    1509171386611760736,
    1544348339008032076,
    1766732708154041516,
    2782266194809203500,
    4033111405577832492,
    9502072876975814700,
    12925150649490378284,
    598115884705507884,
    1156471006175156204,
    1176427771173714956,
    2202535343653263372,
    2784182828086505996,
    3038830279116726796,
    5046909343961458188,
    11609062262454383116,
    14846082047594833420,
    15952546044482276492,
    7145632425167846540,
    7629776477658622476,
    11123678116183404556,
    14954971249349444620,
    684017940032738316,
    913920805378072524,
    1720904179991951436,
    1778359420320291884,
    1787356367637573271,
    2670009146636139159,
    3067346807336122839,
    3922551525962438231,
    14235489780412950103,
    9501770271444121175,
    10221580565669939415,
    11861197078883820247,
    2439222362156999383,
    2748558996220749207,
    5922781385036829079,
    12469276121924187543,
    16261091325936184215,
    1065302461586130839,
    1313194656961708183,
    4258499049233723543,
    6150849355889500567,
    7774774181373209751,
    8386447789819160343,
    8390698769112166150,
    11233626514830742790,
    11566095727518764102,
    11789919516503042982,
    11789919516503042981,
    2844853441099072421,
    8430625674097104805,
    8480202722222333421,
    17732091128504853997,
    17732091128504853996,
    17732091128504853995,
    4414796066977755627,
    4414796066977755626,
    7451487185131929066,
    8555891019940854250,
    11593992013280065002,
    4502633820883023338,
    12979650325278875114,
    15954703408495532522,
    3859618228383229418,
    14311189686992346602,
    4987730461245840874,
    5198082454964545450,
    5327507181074753274,
    5327507181074753273,
    5327507181074753272,
    10468625485069993720,
    17275100207696341752,
    17275100207696341751,
    17778797259624325751,
    1997984705122499191,
    2099971728119725447,
    2224378042729169959,
    4327612543524775975,
    4812435553609650599,
    5962745053204333479,
    8325577189824028583,
    9978972728687877287,
    10077806047741341911,
    12202317357952467415,
    1352910984421435863,
    2338734967841443031,
    2483359055622301271,
    5922378700196194391,
    6328551558072674903,
    10424031416437693015,
    10698781916674329879,
    17169162390675406103,
    17368133612914365751,
    3083368016455255863,
    4832066269266587191,
    7300872927079646775,
    7300872927079646774,
    14750905298401877558,
    15049730970460232246,
    15049730970460232245,
    16661469099975841333,
    16661469099975841332,
    3403833985131825716,
    3422529930114549580,
    3482057606134175868,
    4936449609935147132,
    5391218451900543228,
    8850335501755297532,
    8850335501755297531,
    14080581041774116603,
    17640448369345624827,
    3633710964280852219,
    9088599404451745531,
    12008797913545080571,
    12868687079378866939,
    14424365779403309563,
    15499639983597769467,
    15499639983597769466,
    3136919987983454970,
    3645489439360431290,
    4529474371207286586,
    4806640043543531546,
    5411160074265142554,
    7085377384168862234,
    17802468599890317850,
    2424684770854237210,
    2907974234933496282,
    10751197726656609754,
    10751197726656609753,
    14414888153423757785,
    14636321645467660665,
    1786355786501504377,
    4127333380259304825,
    4929941538268599417,
    12414952944004203641,
    13670081667276227705,
    2120754810724071545,
    3179329737692592377,
    6620442040589215993,
    8490623194097208313,
    11695171555897624057,
    13177275465083618297,
    211546157117899769,
    320749467525961337,
    349213088045767085,
    412131893202623101,
    506856187678209373,
    666784164608719357,
    1303371303855810813,
    1930378421758479229,
    2621188798574144893,
    7600594111377204605,
    12674460081327185277,
    15377802127551755133,
    3006242324990722941,
    5765794533254929789,
    7335224966942379389,
    9623910184685666685,
    9889355523019821437,
    14758752567485514109,
    14758752567485514108,
    4019865820151266684,
    11601797397321334140,
    1869227528538967420,
    1881779672627538978,
    3151804677483153442,
    4133104632852513186,
    5673195104985093794,
    5734861036930332370,
    7222044071019309778,
    13459016231996628690,
    13507261253857721130,
    15706222877530619434,
    1346331933656094250,
    2637946847932604458,
    3543506397364355754,
    12055956501713318570,
    16891105159317728938,
    17246851038874396330,
    7482836825459697322,
    9465180803964927402,
    10007800834391580970,
    10007800834391580969,
    1581693141309634857,
    2166897738768590121,
    2743733508801417513,
    3808062288019684905,
    7165397493723556905,
    7196100967729997273,
    13705246706122409433,
    15739647594445283033,
    15739647594445283032,
    15739647594445283031,
    15739647594445283030,
    2714196810552409814,
    2932290006255658006,
    4772786156303073302,
    6390622992451065110,
    7068190313846733846,
    8587742380791638806,
    8587742380791638805,
    10326175651737335061,
    14325120451967594261,
    16225511881989943317,
    16622105063286023765,
    2593052609205260373,
    2997012664878212437,
    3393813252265404053,
    6427403231910434965,
    5168247330128691349,
    12047491644632076437,
    1670969891992164501,
    3960144567613356437,
    10107562045706182037,
    15359490314407223701,
    644200674478206357,
    741246148779854245,
    1163957745478030181,
    6408972696640758629,
    8133844190775216741,
    8133844190775216740,
    12081498339891932260,
    18343369839292402788,
    232489412116415396,
    978374700451243428,
    1927710544952613540,
    3303174642789874340,
    9693435142129229476,
    8832448830115059364,
    17368039572107397796,
    10102480269991199396,
    5551937437376123556,
    8960430093689752228,
    10646289463540592036,
    10860742166713500580,
    12077160696708896676,
    12744119942175153060,
    14907604740084203172,
    8649887888469272228,
    16617867066405959332,
    5323522536854555300,
    7127381856165292196,
    8111022323637701284,
    9279382060067231652,
    1859151779839936420,
    2305484865548678500,
    2356392258033422404,
    2577927251842197668,
    6275799879767040164,
    6924685622465520932,
    17430591832560516388,
    2247737942245957924,
    2663982786741361316,
    4380330254404428452,
    4758128829898996452,
    10053967586463790820,
    10492127106585750308,
    11421197087346901924,
    13928905398154182052,
    6320151068089011620,
    8494088921686834852,
    10492404496671416996,
    11770454605043346340,
    11770454605043346339,
    15223109380615005603,
    15223109380615005602,
    9288930292358163874,
    9288930292358163873,
    11726653682520058785,
    7321875519128032161,
    7321875519128032160,
    13301696272522470304,
    10095356829886759840,
    11590790975408607136,
    11590790975408607135,
    10251447202807459743,
    17428114707010782111,
    3232228983672833951,
    8770673548489468831,
    807747085469232031,
    4735243734526799263,
    7562856761840869279,
    9743729014510387871,
    14558973271077953183,
    401258500005249183,
    524250169130960847,
    1555012228561607631,
    4000986154528494031,
    6358303210209832911,
    5298727189516636111,
    5361963089431269567,
    5361963089431269566,
    6629695073173940670,
    3435743172048714174,
    5689623086085965246,
    6029950830251935422,
    9424306115056016574,
    16448660604637728958,
    4941556264197980350,
    6524007462261048766,
    7638470506911088190,
    7638470506911088189,
    7638470506911088188,
    8856308810634172732,
    14330603763862833468,
    7043708083563106620,
    8932319076854850108,
    9301924881839394876,
    11138001737289404988,
    921640518520305212,
    1794724617224308412,
    4152066157713517756,
    10953503744565702844,
    10953503744565702843,
    11820032308391020987,
    14655286063716152763,
    17794332976522127291,
    14146006795330742203,
    15747354331172679867,
    15685435999577026747,
    18016708702998273211,
    10585519808871668923,
    12482290391525052859,
    11955677820789885371,
    17174672636861415867,
    15029372885326199227,
    1222465468443808187,
    8702421068484227515,
    11387021710996459451,
    13700551950374941115,
    8387941606501577147,
    8875606637956156795,
    13371549380212185979,
    14002991779568213371,
    3568478738044616059,
    9070287937134341499,
    15632100548063213947,
    15632100548063213946,
    442866334230488442,
    558554158313330442,
    1302996691653858698,
    3546747871275822986,
    3680926818587527898,
    5306784414155800282,
    14199949967880532698,
    14199949967880532697,
    1404791177162242777,
    2235507341550873433,
    6268617819429951833,
    9401884506653902169,
    2034999793394283865,
    2252181457612260633,
    2778060460671599705,
    6042849745129092185,
    13565119951965832281,
    14754465551753225561,
    14754465551753225560,
    13681967506433008984,
    17665070055383803224,
    4879272269194343768,
    6136684528084950872,
    8538443186898749272,
    8538443186898749271,
    10768029892441278551,
    11482115893184207063,
    14265006200089748695,
    14452664656623861463,
    17287533201914998487,
    1371745446464836311,
    2133558637981044183,
    2153681521472870951,
    2503513951808293735,
    2917882133442156391,
    9867069420785436519,
    958781497084577639,
    1201104507161837767,
    2898466368431051975,
    4221334129439839431,
    4707085239991906247,
    8618506178202607559,
    4422695886937511879,
    7519849872633012167,
    13280866895139761095,
    13280866895139761094,
    14252825993772534470,
    15699213879152489670,
    259818969537988294,
    511640037076557734,
    1226614568936444198,
    2046068174445526182,
    3052704686056933926,
    3378583527545082022,
    5063977342503669414,
    8073745120997007526,
    8565313973200271910,
    10247639060068986662,
    11146502187011488934,
    10843419173568486566,
    13831780086668959910,
    15140847448621253798,
    17114858490777360294,
    17291232970866818438,
    17291232970866818437,
    17291232970866818436,
    84567754716009604,
    494098864300076484,
    590127124379434468,
    3659946587763744228,
    4020206153039663012,
    4615495522167791780,
    6440205470323309220,
    7605276889695630756,
    9327918279838982564,
    10516949827751674020,
    10516949827751674019,
    6838102259936397475,
    7141596446158566819,
    13866019963326972323,
    14059243927043663683,
    16348380432772085315,
    16348380432772085314,
    16348380432772085313,
    6379674255943484993,
    12807658199701023297,
    12807658199701023296,
    12807658199701023295,
    12807658199701023294,
    7062373452694514238,
    12205080988497083966,
    14480587047806553918,
    14738908233938336414,
    14738908233938336413,
    17319702710730351773,
    581855396173792669,
    695972944588200077,
    1387453093228731405,
    1987138076185600909,
    12729853818227628941,
    14695227127176358541,
    16409664451348105357,
    1873210416656525453,
    3433410203089390477,
    4337437976290478861,
    7370363075372461325,
    7593314921649340365,
    7593314921649340364,
    10287212949426003404,
    15507012771307402700,
    15958276500454567692,
    4688861721972093708,
    4881664833011587244,
    10772108742587263148,
    12122071793340881068,
    4624346157141487788,
    5173397283181926764,
    6280408896845763948,
    6280408896845763947,
    8627670315674580843,
    8627670315674580842,
    9075015608831656106,
    4879145629315989674,
    5470177807681659562,
    5550615217731229178,
    6284954147790471034,
    10090854299603017082,
    16022121977386978682,
    10157003382316303738,
    16980148826027841914,
    3720994189353975162,
    6707816169288890234,
    16078575165736353658,
    10867882734548393850,
    11934292695110172410,
    12648990085327884282,
    7466455601212620794,
    9078219704935058682,
    15344071957755628794,
    17671255303162470138,
    6374870092487508730,
    12311035521920403194,
    12805364828266044922,
    18242178189049358842,
    18242178189049358841,
    18242178189049358840,
    18242178189049358839,
    1124327567097281527,
    2207147541150420215,
    3741186621196412407,
    3815043427441784055,
    3855459055723799791,
    4840550141405099631,
    7197647170333111407,
    8677875041157155183,
    9122531585467108783,
    5221595673768396207,
    6594378754293576879,
    7253768281383678767,
    13021953075503924015,
    15900454656763540271,
    17356042144280264495,
    18004247052927964975,
    4257688612621039407,
    4489876300225366639,
    5160557940591182191,
    9740413772972283759,
    9740413772972283758,
    13386784365896071534,
    8632156008570515822,
    9304088102779316078,
    17430163026129986414,
    17430163026129986413,
    4595306224968714093,
    5798327345475387245,
    6648538621662849773,
    12261321498280723181,
    5508452710882376429,
    8423421480748001005,
    11039789597233989357,
    12499993227407187693,
    13391457797731906157,
    16509448350931092589,
    478833824647426157,
    718015444867204781,
    737542288563961269,
    1700086806348677301,
    2347978654546164533,
    2579610440953417909,
    3974945285386880949,
    15107213213016868789,
    149851701645731765,
    215813321248023917,
    246470759156772937,
    343795938278501081,
    371257717828579285,
    403074429616759721,
    1078946744346352425,
    1512238714692172713,
    2125876902257547177,
    2715321478029492649,
    3512508678610949929,
    3514389518647856275,
    9456511133309198483,
    13153633325500286099,
    18235477270701114515,
    7073402308713625747,
    12703993286564534419,
    13319365118764914707,
    18360084410494849043,
    18360084410494849042,
    7807800011072812050,
    12315637604711111186,
    12635791962427379154,
    1602387724814269906,
    1719845537303410018,
    4107722057880799586,
    9044027502225527138,
    12810022681072149346,
    6163467844557138786,
    7657064255563407458,
    18357925597176610914,
    14815116201221431394,
    1304898406574300258,
    1919427839577249890,
    3283469148025780322,
    11655222440183109730,
    5728065491134275682,
    7217777316056643426,
    12656760341255337826,
    7843558366485413730,
    8242662580150457250,
    11986166157202762658,
    1291706733552774050,
    4172210926780488610,
    6681825956635170722,
    7540832353365891362,
    8383600753398905250,
    8519493645581589874,
    9808501073647890290,
    12469537751359050610,
    12834667454489574514,
    12834667454489574513,
    4942705830984414321,
    5642113917208456561,
    8242505876032958321,
    8503330049093268561,
    8584486142693059729,
    8584486142693059728,
    11127932761356047504,
    15119290196144686736,
    6855513181771169424,
    6855513181771169423,
    10960823355906153103,
    14860350724431727759,
    11429338504085468303,
    11429338504085468302,
    13791733421747052174,
    16716635464672646798,
    2399815970303436430,
    7120672792328101518,
    8267059781891539854,
    8386609570171070638,
    9700364998640324526,
    6354079465464573870,
    6929635712325204206,
    1735533337817268462,
    8555831323013353710,
    9062745020961657326,
    10112075018622933614,
    4342785169459827310,
    5002188901785258478,
    5698396090230750958,
    10601339481650139886,
    10601339481650139885,
    12099505708495607277,
    1454765363633301997,
    1674577906236206573,
    2192090564544927277,
    3877067180281275437,
    18185385993681859629,
    18185385993681859628,
    8408334277107132460,
    9144615287624441900,
    12232465038946418732,
    9273447683742535724,
    10228546324403593900,
    11083256510429689772,
    18334768575713005484,
    7251026204274046892,
    8484906119836330924,
    9210411474436193708,
    12521294371941167532,
    12521294371941167531,
    610004857444905387,
    913191495210999723,
    1030272043811550747,
    1110236932160471803,
    1999645308739240315,
    2086573428118404683,
    5843347887524072011,
    9243584807752930379,
    5253729860862665803,
    5895785554990510155,
    5945276465452839731,
    7810173142717594675,
    8334823575502698419,
    11129257463275462067,
    17056751797513252275,
    6868942910473446835,
    8877663658463558835,
    8877663658463558834,
    10652687822555051954,
    12007590165892691378,
    15840171347272206770,
    15840171347272206769,
    15840171347272206768,
    2276554202225405360,
    3178271644043407024,
    4232280875750859440,
    4321245930697321408,
    17289467543257770944,
    1764930096972730304,
    2381172034405432640,
    2455777229121811648,
    4947511763546844864,
    6222279714182143424,
    8294028695873774016,
    8353994993758897808,
    8591965286868291856,
    14579527372061752592,
    14579527372061752591,
    16357124301157118991,
    4251893070815504399,
    4485162970698688303,
    4917041968843694319,
    7306947182534098671,
    8613308793411774703,
    8613308793411774702,
    17036904177263666414,
    2800582427354497774,
    3509775508072424430,
    4969801852504232942,
    5598975449871570030,
    8902647067988073070,
    10636369429694444142,
    10636369429694444141,
    11096051293948462957,
    16634642709528783725,
    6309850189102255981,
    10304687641695390573,
    12332839039226269805,
    1541175507479416941,
    3581567296998624877,
    6823304254315797613,
    7959700875596860269,
    16333204252639423341,
    9732985721335116653,
    14634493685928651629,
    14634493685928651628,
    993087284848275308,
    1052442086119711892,
    1257368203592663412,
    1345538642524794484,
    2174028316317399028,
    2646045148123416884,
    2781990910824851204,
    3749112370258388868,
    5017401491699856516,
    5299852675429381028,
    6222830143629134884,
    7071367287056310948,
    7071367287056310947,
    10874837926877909667,
    14657123343645860515,
    14657123343645860514,
    15955016321180192674,
    2658971102809510818,
    4026596097454930082,
    4559023457166986978,
    14946636852028704482,
    17225779003482939618,
    7161163407777309922,
    8353682879190542050,
    8353682879190542049,
    8353682879190542048,
    9940712480064018912,
    11479367098290396640,
    15058563452332707296,
    15429348797611683872,
    10296550067847241760,
    13251758678795606560,
    853733735716700704,
    1918344670327310752,
    3564054056043504800,
    3817590970594028384,
    4405349867917873888,
    13679578553297138400,
    17377660510317205728,
    2735899076803714784,
    3091079997032393888,
    4467682783310698912,
    4467682783310698911,
    4636778876404072287,
    11209752763783374687,
    14747242783137576287,
    7871910813479572831,
    9199789787130009951,
    14939702503488289119,
    18004343438988200287,
    6150332406255846751,
    6461455146060506975,
    10611581083436961119,
    14447067821038211423,
    14447067821038211422,
    7417783215667159390,
    9489682585806688094,
    12295443428572403038,
    8452515910179614046,
    8452515910179614045,
    8452515910179614044,
    11103636693569337180,
    16125316559694421852,
    325984463423881564,
    663572886879408860,
    2204221409364112092,
    2883618248031593564,
    3535517432033449692,
    3583752879821638884,
    5087769015721161188,
    5216908205732824292,
    5267822082021660372,
    5267822082021660371,
    5973556082137549779,
    10127135586151408083,
    15132238521457916371,
    636216646173196243,
    1416222438070155219,
    1480606782568549883,
    2485172544837393403,
    2913126202474447611,
    3708071420352327675,
    7170218502226462203,
    11670554480557308411,
    11896977379484717051,
    2083558176980763643,
    5200211012084422139,
    6722687888964775419,
    263860744537800187,
    356626634200162043,
    374995728060726799,
    562626396649581455,
    668090710731765631,
    1314920694865210367,
    1565971694795356799,
    1626801138371177143,
    3050399631543600311,
    3252588417982718999,
    3943649882267154711,
    5690223247184898327,
    10500972580993406231,
    16587979528985333015,
    16587979528985333014,
    8435841878647835926,
    8842759330760244694,
    6900278005880804822,
    6913177521579022276,
    17403930227288176580,
    1582598453877586372,
    1767622453382162468,
    4561632501269398052,
    12074023931716663844,
    13462712387529293604,
    3390174784045954852,
    4432628136775169316,
    4942173446888271140,
    6840248833121737252,
    8471563730871628580,
    8584088084519716836,
    13055320889882013156,
    17488325539115324388,
    17488325539115324387,
    193141193810237155,
    217073021245487651,
    246357510466964667,
    375761730363109387,
    1691334113702703627,
    3134845592284406795,
    3940496189983812107,
    4086215182968352939,
    4325590533965633931,
    7343354270724715915,
    7973055256243169163,
    8318138276740459659,
    8604211150130435019,
    11442842369059280331,
    12359841103181922507,
    3490773153013303499,
    5528336751933505227,
    6540783476039867467,
    6540783476039867466,
    7804674356539685450,
    11895908996407579722,
    12826223092255614154,
    13382695616004497738,
    14815700757333594186,
    16439951890618587722,
    16439951890618587721,
    11693579203267162697,
    7218948442838297161,
    16022324428703904329,
    16022324428703904328,
    16022324428703904327,
    2779978180900834887,
    2887174734074284759,
    3197367898534435991,
    4962165147331154583,
    8063214183669008535,
    9395576161783525527,
    9395576161783525526,
    10393682632565385238,
    15604714973635722262,
    16867294769871843862,
    3000940605405179926,
    3936818220251076118,
    6620908367456711702,
    7301930289720303126,
    10229665190399330838,
    10229665190399330837,
    12549601405140259861,
    10040344842128778261,
    13159132507357842453,
    321189401840807957,
    333910489905004547,
    339550278152555729,
    389902709000592145,
    407146608122730327,
    3135218545626629463,
    3270900916826941895,
    7096255531431399367,
    10420104930240492487,
    12135436139587214791,
    12135436139587214790,
    6823062890375009734,
    7613107709739409606,
    7892697010757912838,
    7892697010757912837,
    8550469289887318533,
    16907485337985849861,
    16907485337985849860,
    73749600326477828,
    129358754018433956,
    135210429371105938,
    154749653951984478,
    502664213482999262,
    539434336070337334,
    4535220881640194870,
    4535220881640194869,
    10527845868963820341,
    2758850809430377269,
    3206016028606945589,
    5841644046833004853,
    14380517732157750581,
    17302280880833042229,
    2812794098610766133,
    4938000534506490165,
    6908876623200493621,
    9786215493805186101,
    14203569168050332213,
    2148423167720436277,
    2694516932039285493,
    4825779066626087413,
    7688339857985808373,
    7688339857985808372,
    12122724923918984180,
    12455148497246117812,
    12455148497246117811,
    6921502123845785523,
    7036243606352893939,
    7036243606352893938,
    10018792792569501170,
    10475539572065165554,
    10489419441236018372,
    11793475133879807172,
    13428423999554646212,
    14292726630349214148,
    2159664365246519748,
    4282783759924356548,
    8024508970010077124,
    11977766724815483844,
    13893156378369939140,
    13893156378369939139,
];

#[test]
fn mapping() {
    let mut m = RandomMapping {
        prng: 1234567891,
        last_idx: 0,
    };

    for i in 0..2000 {
        assert_eq!(m.next_index(), MAPPING_REF[i]);
    }
}
